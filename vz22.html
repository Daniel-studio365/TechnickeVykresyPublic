<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8">
  <title>vz22</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="css/vz22.css">
</head>
<body>
    <div id="app">
      <aside id="controls">
        <div class="card" id="eps-header">
          <div class="field wide">
            <strong>Cislo referencneho vzoru:</strong>
            <input id="refPartA" class="pill pill-input" type="text" maxlength="10" aria-label="Cislo vzoru cast A" />
            <span>/</span>
            <input id="refPartB" class="pill pill-input short" type="text" maxlength="2" aria-label="Cislo vzoru cast B" />
          </div>
          <div class="field wide" style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
            <strong>Finalny navin:</strong>
            <div class="pill-group" style="display:flex;gap:6px;">
              <select id="finalNavinNumber" class="pill pill-input short">
                <option value="1" selected>1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="8">8</option>
              </select>
              <select id="finalNavinLetter" class="pill pill-input short">
                <option value="A" selected>A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
                <option value="E">E</option>
              </select>
            </div>
            <strong>Sposob tlace:</strong>
            <select id="printSide">
              <option value="vrchna" selected>vrchna</option>
              <option value="spodna">spodna</option>
            </select>
            <strong>Rezanie:</strong>
            <label style="display:flex;align-items:center;gap:4px;">
              <input type="radio" name="rezanie" id="rezanie-ano" value="ano">
              ano
            </label>
              <label style="display:flex;align-items:center;gap:4px;">
                <input type="radio" name="rezanie" id="rezanie-nie" value="nie" checked>
                nie
              </label>
            </div>
          <div class="row">
            <button id="btnOpenFirmManager" type="button" class="secondary">Firmy (sprava)</button>
          </div>
        </div>
        <h3>Zakladne rozmery</h3>
      <label>W (sek): <input type="number" id="W" value="400"></label>
      <label>L (dlzka): <input type="number" id="L" value="600"></label>
      <label>G (spodna zalozka): <input type="number" id="G" value="50"></label>
      <label>K (chlopna): <input type="number" id="K" value="45"></label>
      <label>Sirka (vrecko): <input type="number" id="BagWidth" value="400"></label>
      <span class="sep"></span>

      <h3>Perforacia</h3>
      <label>Strana perforacie:
        <select id="PerfSide">
          <option value="prava" selected>prava</option>
          <option value="lava">lava</option>
        </select>
      </label>
      <label>Odsadenie od lavej hrany praveho G (mm): <input type="number" id="PerfOffset" value="7" min="0"></label>
      <span class="sep"></span>

      <h3>Dierovanie v K</h3>
      <label>C - roztec &Oslash;14 v K: <input type="number" id="Cpitch" value="160"></label>
      <label>Os v K od lavej hrany (ak prazdne K/2): <input type="number" id="AxisInK" placeholder="K/2"></label>
      <div id="warnC">C je mimo W (zasahuje okraj)</div>
      <div id="warnAxis">Os je mimo 0..K</div>
      <span class="sep"></span>

      <h3>Zaseky v K</h3>
      <label>Dlzka zaseku v K: <input type="number" id="NotchLen" value="7"></label>
      <label><input type="checkbox" id="toggle-notches"> Zobrazit zaseky</label>
      <span class="sep"></span>

      <h3>Vzduchove otvory</h3>
      <label>Vzduch. otvor od okraja: <input type="number" id="AirEdge" value="30"></label>
      <label>Prvy vzduch. otvor od rucky: <input type="number" id="AirXAbs" value=""></label>
      <label><input type="checkbox" id="AirInGOnly"> Vzduchove otvory len v zalozke</label>
      <span class="sep"></span>

      <h3>Text / koty</h3>
      <label>Velkost textu:
        <div class="row">
          <input type="range" id="fontPx" min="8" max="28" value="14">
          <span id="fontPxVal">14 px</span>
        </div>
      </label>
      <label>Meranie (H/V):
        <select id="measureMode">
          <option value="off" selected>vypnute</option>
          <option value="h">horizontalne</option>
          <option value="v">vertikalne</option>
        </select>
      </label>
      <div class="row" style="gap:6px;">
        <button id="measure-cancel" type="button" class="secondary">Zrusit meranie</button>
        <button id="measure-clear" type="button" class="warn">Vymazat merania</button>
      </div>
      <label><input type="checkbox" id="toggle-grid"> Mriezka</label>
      <span class="sep"></span>

      <label>Podkladovy obrazok (PNG/JPG):
        <input type="file" id="bgFile" accept="image/png,image/jpeg,image/webp,image/gif,application/pdf">
      </label>
      <div class="row" style="gap:6px;flex-wrap:wrap;">
        <label style="flex:1;">Sirka podkladu (mm): <input type="number" id="bgWidth" min="0"></label>
        <label style="flex:1;">Vyska podkladu (mm): <input type="number" id="bgHeight" min="0"></label>
      </div>
      <div class="row" style="gap:6px;flex-wrap:wrap;">
        <button type="button" id="bg-rot-left" class="secondary" style="flex:1;">Otocit -90</button>
        <button type="button" id="bg-rot-180" class="secondary" style="flex:1;">Otocit 180</button>
        <button type="button" id="bg-flip" class="secondary" style="flex:1;">Zrkadlit horiz.</button>
      </div>
      <label>Priehladnost podkladu:
        <div class="row">
          <input type="range" id="bgOpacity" min="0" max="1" step="0.05" value="0.6">
          <span id="bgOpacityVal">60 %</span>
        </div>
      </label>
      <div class="row" style="gap:6px;">
        <button id="bg-calib" type="button" class="secondary">Kalibracia podkladu</button>
        <button id="bg-calib-cancel" type="button" class="warn" style="display:none;">Zrusit kalibraciu</button>
        <button id="bg-clear" type="button" class="secondary">Vymazat obrazok</button>
      </div>
      <span class="sep"></span>

      <div style="margin-top:6px;font-weight:600;font-size:13px;">Tlac dokumentu (PNG s tabulkami):</div>
      <div class="row" style="gap:8px;flex-wrap:wrap;margin-top:4px;">
        <label style="display:flex;align-items:center;gap:6px;">Format:
          <select id="exportSize" disabled title="Pevne A3">
            <option value="A3" selected>A3</option>
          </select>
        </label>
        <label style="display:flex;align-items:center;gap:6px;">Orientacia:
          <select id="exportOrient">
            <option value="portrait">na vysku</option>
            <option value="landscape" selected>na sirku</option>
          </select>
        </label>
        <label style="display:flex;align-items:center;gap:6px;">DPI:
          <select id="exportDPI" disabled title="Pevne 150 dpi">
            <option value="150" selected>150</option>
          </select>
        </label>
      </div>
      <div class="row" style="margin-top:6px;">
        <button id="btn-reset" class="secondary">Reset</button>
        <button id="btn-export">Export PDF 1:1</button>
        <button id="btn-print">Tlac dokumentu (PNG)</button>
        <button id="btn-save" type="button">Ulozit (JSON)</button>
        <button id="btn-load" type="button">Nacitat</button>
        <input type="file" id="loadFile" accept="application/json" style="display:none;">
      </div>
    </aside>

    <section id="workarea">
      <div id="top-panels">
                <div class="card" id="left-notes">
          <div class="field wide">
            <strong>Cislo referencneho vzoru:</strong>
            <span id="refCodeText" class="pill">vz-22</span>
          </div>
          <div class="field wide" style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
            <strong>Finalny navin:</strong>
            <span id="finalNavinText" class="pill">1A</span>
            <strong>Sposob tlace:</strong>
            <span id="printSideText" class="pill">vrchna</span>
            <strong>Rezanie:</strong>
            <span id="rezanieText" class="pill">nie</span>
          </div>
          <div class="field two-cols">
            <strong>Navin tlac:</strong>
            <span id="navinTlacText" class="pill">1A</span>
          </div>
          <div class="field"><strong>Navin montaz:</strong> <span id="lblNavinTlac" class="pill">V1</span></div>
          <div class="wide"><span class="note">ZADNA STRANA</span></div>
        </div>
<div class="card" id="right-notes">
          <div class="meta">
            <span>Casova peciatka:</span>
            <span id="stamp" class="badge">-</span>
            <span>Vzor:</span>
            <span id="vzCode" class="badge">vz-22</span>
          </div>
          <div class="field">
            <label for="porCislo">por. cislo vyrobku</label>
            <input type="text" id="porCislo" placeholder="Dopln poradie / cislo vyrobku" maxlength="60">
          </div>
          <div class="field">
            <label for="otherNotes">ostatne poznamky</label>
            <input type="text" id="otherNotes" placeholder="Dopln doplnujuce info / poznamky" maxlength="60">
          </div>
          <div class="note">PREDNA STRANA</div>
        </div>
      </div>

      <div class="card" id="canvas-wrap">
        <div id="svgHolder">
          <svg id="svgRoot" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 800" aria-label="nahlad"></svg>
          <div class="hint">Koliesko = zoom, tahanie = posun vykresu/podkladu.</div>
        </div>
      </div>

      <div class="card" id="bottom-notes">
        <div class="bottom-item">
          <label class="bottom-label">Obrazok:</label>
          <input type="file" id="bottomImgInput" accept="image/png,image/jpeg,image/webp,image/gif" />
          <div class="bottom-box"><img id="bottomImgPreview" alt="Nahlad obrazka" /></div>
        </div>
        <div class="bottom-item">
          <label class="bottom-label" for="bottomText1">Poznamky:</label>
          <div class="bottom-box">
            <textarea id="bottomText1" class="bottom-textarea" placeholder="Dopln text"></textarea>
          </div>
        </div>
        <div class="bottom-item">
          <label class="bottom-label" for="bottomText2">Poznamky technologa:</label>
          <div class="bottom-box">
            <textarea id="bottomText2" class="bottom-textarea" placeholder="Dopln text"></textarea>
          </div>
        </div>
      </div>
    </section>
  </div>

  <div id="log"></div>
  <script src="js/eps_map.js"></script>
  <script src="js/eps_import.js"></script>
  <script src="js/vz22.js"></script>
</body>
</html>

