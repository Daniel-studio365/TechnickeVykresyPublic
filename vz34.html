<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8">
  <title>vz34</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="css/vz34.css">
</head>
<body>
  <div id="app">
    <aside id="controls">
      <h3>Základné rozmery</h3>
      <label>W (šírka): <input type="number" id="W" value="400"></label>
      <label>L (dĺžka): <input type="number" id="L" value="600"></label>
      <label>G (spodná záložka): <input type="number" id="G" value="50"></label>
      <label>K (chlopňa): <input type="number" id="K" value="45"></label>
      <span class="sep"></span>

      <h3>Perforácia</h3>
      <label>P - odsadenie perforácie od G (min 10): <input type="number" id="P" value="55" min="10"></label>
      <label>Ph - výška perforácie: <input type="number" id="Ph" value="240"></label>
      <span class="sep"></span>

      <h3>Dierovanie v K</h3>
      <label>C - rozteč &Oslash;14 v K: <input type="number" id="Cpitch" value="160"></label>
      <label>Os v K od ľavej hrany (ak prázdne K/2): <input type="number" id="AxisInK" placeholder="K/2"></label>
      <div id="warnC" class="warn-text" style="display:none;">C je mimo W (zasahuje okraj)</div>
      <div id="warnAxis" class="warn-text" style="display:none;">Os je mimo 0..K</div>
      <span class="sep"></span>

      <h3>Záseky v K</h3>
      <label>Dĺžka záseku v K (mm): <input type="number" id="NotchLen" value="7" min="1"></label>
      <label><input type="checkbox" id="toggle-notches" checked> Zobraziť záseky v K</label>
      <span class="sep"></span>

      <h3>Vzduchové otvory</h3>
      <label>Vzduch. otvor od okraja (mm): <input type="number" id="AirEdge" value="30" min="0"></label>
      <label>X od okrajov G (mm): <input type="number" id="AirXAbs" value="25" min="0"></label>
      <label style="font-size:13px;"><input type="checkbox" id="AirXAuto" checked> X = G (auto)</label>
      <label>Počet otvorov (v L):
        <select id="AirCount">
          <option>2</option><option>4</option><option>6</option><option selected>8</option>
        </select>
      </label>
      <label>Rozteč otvorov (mm): <input type="number" id="AirPitch" value="40" min="0"></label>
      <span class="sep"></span>

      <h3>Text / kóty</h3>
      <label>Veľkosť písma:
        <div class="row">
          <input type="range" id="fontPx" min="10" max="28" value="14">
          <span id="fontPxVal">14 px</span>
        </div>
      </label>
      <label>Meranie (H/V):
        <select id="measureMode">
          <option value="off" selected>vypnuté</option>
          <option value="h">horizontálne</option>
          <option value="v">vertikálne</option>
        </select>
      </label>
      <div class="row" style="gap:6px;">
        <button id="measure-cancel" type="button" class="secondary">Zrušiť meranie</button>
        <button id="measure-clear" type="button" class="warn">Vymazať merania</button>
      </div>
      <label><input type="checkbox" id="toggle-grid"> Mriežka</label>
      <span class="sep"></span>

      <h3>Podkladový obrázok</h3>
      <label>Obrázok (PNG/JPG):
        <input type="file" id="bgFile" accept="image/png,image/jpeg,image/webp,image/gif,application/pdf">
      </label>
      <div class="row" style="gap:6px;flex-wrap:wrap;">
        <label style="flex:1;">Šírka podkladu (mm): <input type="number" id="bgWidth" min="0"></label>
        <label style="flex:1;">Výška podkladu (mm): <input type="number" id="bgHeight" min="0"></label>
      </div>
      <div class="row" style="gap:6px;flex-wrap:wrap;">
        <button type="button" id="bg-rot-left" class="secondary" style="flex:1;">Otočiť -90</button>
        <button type="button" id="bg-rot-180" class="secondary" style="flex:1;">Otočiť 180</button>
        <button type="button" id="bg-rot-right" class="secondary" style="flex:1;">Otočiť +90</button>
      </div>
      <label>Priehľadnosť podkladu:
        <div class="row">
          <input type="range" id="bgOpacity" min="0" max="1" step="0.05" value="0.6">
          <span id="bgOpacityVal">60 %</span>
        </div>
      </label>
      <div class="row" style="gap:6px;">
        <button id="bg-calib" type="button" class="secondary">Kalibrácia podkladu</button>
        <button id="bg-calib-cancel" type="button" class="warn" style="display:none;">Zrušiť kalibráciu</button>
        <button id="bg-clear" type="button" class="secondary">Vymazať obrázok</button>
      </div>
      <span class="sep"></span>

      <div style="margin-top:6px;font-weight:600;font-size:13px;">Tlač dokumentu (PNG s tabuľkami):</div>
      <div class="row" style="gap:8px;flex-wrap:wrap;margin-top:4px;">
        <label style="display:flex;align-items:center;gap:6px;">Formát:
          <select id="exportSize" disabled title="Pevne A3">
            <option value="A3" selected>A3</option>
          </select>
        </label>
        <label style="display:flex;align-items:center;gap:6px;">Orientácia:
          <select id="exportOrient">
            <option value="landscape" selected>na sirku</option>
            <option value="portrait">na vysku</option>
          </select>
        </label>
        <label style="display:flex;align-items:center;gap:6px;">DPI:
          <select id="exportDPI" disabled title="Pevne 150 dpi">
            <option value="150" selected>150</option>
          </select>
        </label>
      </div>

      <div class="row" style="margin-top:6px;flex-wrap:wrap;gap:6px;">
        <button id="btn-reset" class="secondary">Reset</button>
        <button id="btn-export">Export PDF 1:1</button>
        <button id="btn-print">Tlač dokumentu (PNG)</button>
        <button id="btn-save" type="button">Uložiť (JSON)</button>
        <button id="btn-load" type="button">Načítať</button>
        <input type="file" id="loadFile" accept="application/json" style="display:none;">
      </div>
    </aside>

    <section id="workarea">
      <div id="top-panels">
        <div class="card" id="left-notes">
          <div class="field wide">
            <strong>Názov súboru:</strong>
            <input id="refPartA" class="pill pill-input" type="text" maxlength="10" aria-label="Cislo vzoru cast A" />
            <span>/</span>
            <input id="refPartB" class="pill pill-input short" type="text" maxlength="2" aria-label="Cislo vzoru cast B" />
          </div>
          <div class="field wide" style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
            <strong>Finalny navin:</strong>
            <div class="pill-group" style="display:flex;gap:6px;">
              <select id="finalNavinNumber" class="pill pill-input short">
                <option value="1" selected>1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
              </select>
              <select id="finalNavinLetter" class="pill pill-input short">
                <option value="A" selected>A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
                <option value="E">E</option>
              </select>
            </div>
            <strong>Sposob tlace:</strong>
            <select id="printSide">
              <option value="vrchna" selected>vrchna</option>
              <option value="spodna">spodna</option>
            </select>
            <strong>Rezanie:</strong>
            <label style="display:flex;align-items:center;gap:4px;">
              <input type="radio" name="rezanie" id="rezanie-ano" value="ano">
              ano
            </label>
            <label style="display:flex;align-items:center;gap:4px;">
              <input type="radio" name="rezanie" id="rezanie-nie" value="nie" checked>
              nie
            </label>
          </div>
          <div class="field two-cols">
            <strong>Navin tlac:</strong>
            <span id="navinTlacText" class="pill">1A</span>
          </div>
          <div class="field"><strong>Navin montaz:</strong> <span id="lblNavinTlac" class="pill">V1</span></div>
          <div class="wide"><span class="note">PREDNA STRANA / FOTOBUNKA NA STRANE OBSLUHY</span></div>
        </div>

        <div class="card" id="right-notes">
          <div class="meta">
            <span>Časová pečiatka:</span>
            <span id="stamp" class="badge">-</span>
            <span>Vzor:</span>
            <span id="vzCode" class="badge">vz-34</span>
          </div>
          <div class="field">
            <label for="porCislo">Por. číslo výrobku</label>
            <input type="text" id="porCislo" placeholder="Doplň poradie / číslo výrobku" maxlength="60">
          </div>
          <div class="field">
            <label for="otherNotes">Ostatné poznámky</label>
            <input type="text" id="otherNotes" placeholder="Doplň doplňujúce info / poznámky" maxlength="60">
          </div>
          <div class="note">CHLOPŇA/ ZS NA STRANE POHONU</div>
        </div>
      </div>

      <div class="card" id="canvas-wrap">
        <div id="svgHolder">
          <svg id="svgRoot" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 800" aria-label="nahlad"></svg>
          <div class="hint">Koliesko = zoom, tahanie = posun vykresu/podkladu.</div>
        </div>
      </div>

      <div class="card" id="bottom-notes">
        <div class="bottom-item">
          <label class="bottom-label">Obrazok:</label>
          <input type="file" id="bottomImgInput" accept="image/png,image/jpeg,image/webp,image/gif" />
          <div class="bottom-box"><img id="bottomImgPreview" alt="Nahlad obrazka" /></div>
        </div>
        <div class="bottom-item">
          <label class="bottom-label" for="bottomText1">Poznamky:</label>
          <div class="bottom-box">
            <textarea id="bottomText1" class="bottom-textarea" placeholder="Dopln text"></textarea>
          </div>
        </div>
        <div class="bottom-item">
          <label class="bottom-label" for="bottomText2">Poznamky technologa:</label>
          <div class="bottom-box">
            <textarea id="bottomText2" class="bottom-textarea" placeholder="Dopln text"></textarea>
          </div>
        </div>
      </div>
    </section>
  </div>

  <div id="log"></div>
  <script src="js/vz34.js"></script>
</body>
</html>
